# name: test33
# on: push

# jobs:
#   get_app_version:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v2
#         with:
#           fetch-depth: 0
#       - name: Set env vars
#         id: set_env_vars
#         shell: pwsh
#         run: |


#           $env:APP_VERSION = git describe --tags --always --first-parent

#           if ( $env:APP_VERSION[0] -eq 'v' ) {
#               $env:APP_VERSION = $env:APP_VERSION.substring(1)
#           }
#           echo "$$env:APP_VERSION env var not set. Setting to default: $env:APP_VERSION"

#           echo "::set-output name=AppVersionEnv::$env:APP_VERSION"

#     outputs:
#       AppVersionEnv: ${{ steps.set_env_vars.outputs.AppVersionEnv }}

#   build_frontend:
#     runs-on: ubuntu-latest
#     needs: [get_app_version]
#     env:
#       APP_VERSION: ${{ needs.get_app_version.outputs.AppVersionEnv }}
#     steps:

#       - name: Checkout repo
#         uses: actions/checkout@v2

#       - name: Set up Python
#           uses: actions/setup-python@v2
#           with:
#             python-version: 3.8
      
#       - name: echo
#         run: |
#           ls
#           echo $APP_VERSION

      
#       - name: run python
#         run: |
#           python test.py



name: Build
on: push

env:
  SLN_FILE_NAME: 'S4_ASI_Loader.sln'

jobs:
  build-debug:
    # https://github.com/actions/virtual-environments#available-environments
    runs-on: windows-latest
    steps:
    - name: Checkout repo
      uses: actions/checkout@v2
    - name: Add msbuild to PATH
      uses: microsoft/setup-msbuild@v1.0.2
      # with:
      #   vs-version: '[16.4,16.5)'

    - name: Build debug
      run: |
        msbuild ${{ env.SLN_FILE_NAME }} /property:Configuration=Debug
    - name: Upload debug build as artifact
      uses: actions/upload-artifact@v2
      with:
        name: build-debug
        path: |
          Debug/

  build-release:
    # https://github.com/actions/virtual-environments#available-environments
    runs-on: windows-latest
    steps:
    - name: Checkout repo
      uses: actions/checkout@v2
    - name: Add msbuild to PATH
      uses: microsoft/setup-msbuild@v1.0.2
      # with:
      #   vs-version: '[16.4,16.5)'

    - name: Build release
      run: |
        msbuild ${{ env.SLN_FILE_NAME }} /property:Configuration=Release
    - name: Upload build as artifact
      uses: actions/upload-artifact@v2
      with:
        name: build-release
        path: |
          Release/*.exe